import streamlit as st
import pandas as pd
import io
import numpy as np
import openpyxl
from openpyxl.styles import PatternFill, Border, Side, Alignment
from openpyxl.utils import get_column_letter
from datetime import datetime

# --------------------------------------------------------------------------
# í•¨ìˆ˜ ì •ì˜
# --------------------------------------------------------------------------

def to_excel_formatted(df, format_type=None):
    """ë°ì´í„°í”„ë ˆì„ì„ ì„œì‹ì´ ì ìš©ëœ ì—‘ì…€ íŒŒì¼ í˜•ì‹ì˜ BytesIO ê°ì²´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜"""
    output = io.BytesIO()
    df_to_save = df.fillna('')
    df_to_save.to_excel(output, index=False, sheet_name='Sheet1')
    
    workbook = openpyxl.load_workbook(output)
    sheet = workbook.active

    # 1. ì…€ ë„ˆë¹„ ìë™ ì¡°ì ˆ
    for column_cells in sheet.columns:
        max_length = 0
        column = column_cells[0].column_letter
        for cell in column_cells:
            try:
                if cell.value:
                    cell_text = str(cell.value)
                    if len(cell_text) > max_length:
                        max_length = len(cell_text)
            except:
                pass
        adjusted_width = (max_length + 2) * 1.2
        sheet.column_dimensions[column].width = adjusted_width

    # 2. í¬ì¥ ë¦¬ìŠ¤íŠ¸ ê³ ê¸‰ ì„œì‹ ì ìš©
    if format_type == 'packing_list':
        thin_border = Border(left=Side(style='thin'), right=Side(style='thin'), top=Side(style='thin'), bottom=Side(style='thin'))
        odd_fill = PatternFill(start_color="F2F2F2", end_color="F2F2F2", fill_type="solid")
        
        for row in sheet.iter_rows(min_row=1, max_row=sheet.max_row, min_col=1, max_col=sheet.max_column):
            for cell in row:
                cell.border = thin_border
        
        bundle_start_row = 2
        for row_num in range(2, sheet.max_row + 2):
            current_bundle_cell = sheet.cell(row=row_num, column=1)
            
            if (current_bundle_cell.value) or (row_num > sheet.max_row):
                if row_num > 2:
                    bundle_end_row = row_num - 1
                    prev_bundle_num_str = str(sheet.cell(row=bundle_start_row, column=1).value)
                    
                    if prev_bundle_num_str.isdigit():
                        prev_bundle_num = int(prev_bundle_num_str)
                        if prev_bundle_num % 2 != 0:
                            for r in range(bundle_start_row, bundle_end_row + 1):
                                for c in range(1, sheet.max_column + 1):
                                    sheet.cell(row=r, column=c).fill = odd_fill
                    
                    if bundle_start_row < bundle_end_row:
                        sheet.merge_cells(start_row=bundle_start_row, start_column=1, end_row=bundle_end_row, end_column=1)
                        merged_cell = sheet.cell(row=bundle_start_row, column=1)
                        merged_cell.alignment = Alignment(vertical='center', horizontal='center')
                
                bundle_start_row = row_num
    
    final_output = io.BytesIO()
    workbook.save(final_output)
    final_output.seek(0)
    
    return final_output.getvalue()


def process_all_files(file1, file2, file3):
    """3ê°œì˜ íŒŒì¼ì„ ë°›ì•„ 4ì¢…ë¥˜ì˜ ìµœì¢… ê²°ê³¼ë¬¼ì„ ìƒì„±í•˜ëŠ” ë©”ì¸ í•¨ìˆ˜"""
    try:
        # ìƒí’ˆ ë§ˆìŠ¤í„° ì •ë³´ë¥¼ ì½”ë“œ ë‚´ì— ë°ì´í„°ë¡œ ì§ì ‘ ë‚´ì¥
        master_data_string = """SKUì½”ë“œ,SKUìƒí’ˆëª…,ê³¼ì„¸ì—¬ë¶€,ì…ìˆ˜ëŸ‰
G604E,[BOX] ê°€ì“°ì˜¤ ìŠˆí† ìš° 1kg,ê³¼ì„¸,6
S011E,[BOX] ê³ ë˜ë¯¸ ê°€ë¼ì•„ê²ŒíŒŒìš°ë”2kg,ê³¼ì„¸,
G510E,[BOX] ê³ ë˜ë¯¸ ê°€ì¯”ì˜¤ì°¸ì¹˜ë‹¤ë‹¤ë¼1kg,ë©´ì„¸,8
G028E,[BOX] ê³ ë˜ë¯¸ ê°€ì¯”ì˜¤ì°¸ì¹˜ë‹¤ë‹¤ë¼2kg,ë©´ì„¸,
G024E,[BOX] ê³ ë˜ë¯¸ ê°„ì¥ëŒ€í•˜ì¥ [300g],ê³¼ì„¸,
G090E,[BOX] ê³ ë˜ë¯¸ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 500g,ê³¼ì„¸,12
G035E,[BOX] ê³ ë˜ë¯¸ ê²Œê°€ë¼ì•„ê²Œ500g,ê³¼ì„¸,
G686E,[BOX] ê³ ë˜ë¯¸ ê³ ë…¸ì™€ë‹¤ 500g,ë©´ì„¸,12
G034E,[BOX] ê³ ë˜ë¯¸ ê¹¡ìƒˆìš°ê°€ë¼ì•„ê²Œ1kg,ê³¼ì„¸,
G656E,[BOX] ê³ ë˜ë¯¸ ë‚ ì¹˜ì•Œ ìŠ¤ì¹¼ë › 300g,ê³¼ì„¸,20
G097E,[BOX] ê³ ë˜ë¯¸ ë§ˆë¼í•´ë¬¼ëª¨ë‘  920g x 10EA,ê³¼ì„¸,
G521E,[BOX] ê³ ë˜ë¯¸ ëª¨ì¦ˆì¿ 900g (ìµœì‹ ),ê³¼ì„¸,8
G037E,[BOX] ê³ ë˜ë¯¸ ëª¨ì°Œë¦¬ë„í›„ íŒŒìš°ë”1kg,ê³¼ì„¸,
G971E,[BOX] ê³ ë˜ë¯¸ ë³´íƒ€ë¥´ê°€ 150g + ë¯¸ë‹ˆ ê°•íŒ ì„¸íŠ¸,ê³¼ì„¸,6
G103E,[BOX] ê³ ë˜ë¯¸ ë¶ˆë§› ì­ˆê¾¸ë¯¸ë³¶ìŒ 340g,ê³¼ì„¸,
G523E,[BOX] ê³ ë˜ë¯¸ ë¶ˆë§› ì­ˆê¾¸ë¯¸ë³¶ìŒ 800g (400g x 2ea),ê³¼ì„¸,10
G033E,[BOX] ê³ ë˜ë¯¸ ìƒˆìš°ì‚´ê°€ë¼ì•„ê²Œ1kg,ê³¼ì„¸,
G112E,[BOX] ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ ìŠ¬ë¼ì´ìŠ¤ 20g x 10ea,ê³¼ì„¸,10
G952E,[BOX] ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ ì¹´ë¼ìŠ¤ë¯¸ 1kg,ê³¼ì„¸,5
G137E,[BOX] ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ íŒŒìš°ë” 60g,ê³¼ì„¸,9
G610E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ë‹ˆì‹± L 1kg,ê³¼ì„¸,6
G609E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ë‹ˆì‹± M 1kg,ê³¼ì„¸,6
G646E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” L 150g,ê³¼ì„¸,30
G514E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” M 120g,ê³¼ì„¸,30
G649E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” S 100g,ê³¼ì„¸,30
G645E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” XS 70g,ê³¼ì„¸,30
G515E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”720g,ê³¼ì„¸,
G516E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”750g,ê³¼ì„¸,
G513E,[BOX] ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”S 700g x 8ê°œì…,ê³¼ì„¸,
G527E,[BOX] ê³ ë˜ë¯¸ ì–‘ë…ê¼¬ë§‰ì¥1kg,ê³¼ì„¸,6
G538E,[BOX] ê³ ë˜ë¯¸ ì–´ë‹ˆì–¸ íƒ€ì½”ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
G528E,[BOX] ê³ ë˜ë¯¸ ì—°ì–´íƒ€ë‹¤ë¼ 1kg,ê³¼ì„¸,8
G059E,[BOX] ê³ ë˜ë¯¸ ì—¼ì¥ëª¨ì¦ˆì¿ 750g,ë©´ì„¸,
G135E,[BOX] ê³ ë˜ë¯¸ ìœ ìí°ì¦ˆì†ŒìŠ¤ 600g,ê³¼ì„¸,
G098E,[BOX] ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ë©”ë¡œ êµ¬ì´ 450g x 10EA,ê³¼ì„¸,
G099E,[BOX] ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ë©”ë¡œ ë¨¸ë¦¬ êµ¬ì´ 750g x 10EA,ê³¼ì„¸,
G100E,[BOX] ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ì—°ì–´ êµ¬ì´ 750g x 10EA,ê³¼ì„¸,
D625E,[BOX] ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ììˆ™ í†µì˜¤ì§•ì–´ M 500g x 10EA,ê³¼ì„¸,
G031E,[BOX] ê³ ë˜ë¯¸ ì´ê¹Œê²Œì†Œê°€ë¼ì•„ê²Œ1kg,ê³¼ì„¸,
G529E,[BOX] ê³ ë˜ë¯¸ ììˆ™ë¬¸ì–´ë‹¤ë¦¬300g,ë©´ì„¸,30
G023E,[BOX] ê³ ë˜ë¯¸ ì¥ì–´êµ¬ì´ [150g],ê³¼ì„¸,
G030E,[BOX] ê³ ë˜ë¯¸ ì°¸ì¹˜ì•Œì¡°ë¦¼1kg,ê³¼ì„¸,
G787E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê³¨ë“œ 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G532E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê³¨ë“œ 300g MSC ì¸ì¦,ê³¼ì„¸,20
G786E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê·¸ë¦° 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G531E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê·¸ë¦° 300g MSC ì¸ì¦,ê³¼ì„¸,20
G788E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ìŠ¤ì¹¼ë › 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G533E,[BOX] ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ìŠ¤ì¹¼ë › 300g MSC ì¸ì¦,ê³¼ì„¸,20
D695E,[BOX] ê³ ë˜ë¯¸ ì¹´ì¦ˆë…¸ì½”ë‹ˆì‹± 500g,ê³¼ì„¸,12
G094E,[BOX] ê³ ë˜ë¯¸ ì½”ëª¨ì¹˜ ì•¼ë¦¬ì´ê¹Œ 750g,ê³¼ì„¸,
G032E,[BOX] ê³ ë˜ë¯¸ íƒ€ì½”ê°€ë¼ì•„ê²Œ1kg,ê³¼ì„¸,
D945E,[BOX] ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ 250g,ê³¼ì„¸,20
G539E,[BOX] ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ ë§ˆì¼ë“œ 1kg,ê³¼ì„¸,6
G677E,[BOX] ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ í”„ë¡œ 1kg,ê³¼ì„¸,6
D631E,[BOX] ê³ ë˜ë¯¸ í”„ë¡œí ëŸ¬ í´ë¨ ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
D630E,[BOX] ê³ ë˜ë¯¸ í”„ë¡œí ëŸ¬ í´ë¨ ì™€ì‚¬ë¹„ 500g,ê³¼ì„¸,12
G565E,[BOX] ê³ ë˜ë¯¸ í™ê²Œì‚´ í¬ë¦¼ íŒŒìŠ¤íƒ€ ì†ŒìŠ¤ 1kg,ê³¼ì„¸,6
G608E,[BOX] ê³ ë˜ì¡°ê°œ ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
D603E,[BOX] ë‚™ì§€ì—°í¬íƒ•(R) 600g x 12ea,ê³¼ì„¸,12
G605E,[BOX] ë§ˆêµ¬ë¡œ ìŠˆí† ìš° 1kg,ê³¼ì„¸,6
D615E,[BOX] ë§ˆë¼ë£½ìƒ¤(R) 580g x 12ea,ê³¼ì„¸,12
D616E,[BOX] ë§ˆë¼ìƒˆìš°(R) 580g x 12ea,ê³¼ì„¸,12
G522E,[BOX] ë§¤ì½¤ì¹¼ì¹¼ ë°”ì§€ë½ìˆ ì°œ 500g (ëƒ‰ì¥),ê³¼ì„¸,10
D051E,[BOX] ëª¨ë‘ í•´ë¬¼íƒ•(R) 750g x 12ea,ê³¼ì„¸,12
D646E,[BOX] ëª¨ì¦ˆì¿  80g (ëƒ‰ì¥),ê³¼ì„¸,30
D055E,[BOX] ë¯¼ì–´ë§¤ìš´íƒ•(R) 680g x 12ea,ê³¼ì„¸,12
D102E,[BOX] ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D601E,[BOX] ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 400g x 12ê°œì…,ê³¼ì„¸,
D013E,[BOX] ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 80g X 30ê°œì…,ê³¼ì„¸,30
D008E,[BOX] ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ì¥ 700g x 12ê°œì…,ê³¼ì„¸,
D739E,[BOX] ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 320g(80g x 4ea)(ëƒ‰ë™),ë©´ì„¸,8
D602E,[BOX] ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 400g X 12ê°œì…,ë©´ì„¸,
D018E,[BOX] ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 80g X 30ê°œì…,ë©´ì„¸,30
D603E,[BOX] ì„¤ë˜ë‹´ ë‚™ì§€ì—°í¬íƒ• 600g x 12ea,ê³¼ì„¸,
D603E,[BOX] ì„¤ë˜ë‹´ ë‚™ì§€ì—°í¬íƒ• 680g,ë©´ì„¸,12
D099E,[BOX] ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D612E,[BOX] ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 400g x 12ê°œì…,ê³¼ì„¸,
D014E,[BOX] ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 80gX30ê°œì…,ê³¼ì„¸,30
D615E,[BOX] ì„¤ë˜ë‹´ ë§ˆë¼ë£½ìƒ¤ 580g x 12ea,ê³¼ì„¸,
D010E,[BOX] ì„¤ë˜ë‹´ ë§ˆë¼ìƒˆìš° 580g,ë©´ì„¸,
D616E,[BOX] ì„¤ë˜ë‹´ ë§ˆë¼ìƒˆìš° 580g x 12ea,ê³¼ì„¸,
D617E,[BOX] ì„¤ë˜ë‹´ ë§¤ì½¤ ì¹ ê²Œì “ 400g x 12ê°œì…,ê³¼ì„¸,
D016E,[BOX] ì„¤ë˜ë‹´ ë§¤ì½¤ ì¹ ê²Œì “ 80g x 30ê°œì…,ê³¼ì„¸,
D618E,[BOX] ì„¤ë˜ë‹´ ëª¨ë‘ í•´ë¬¼íƒ• 750g x 12ea,ê³¼ì„¸,
D033E,[BOX] ì„¤ë˜ë‹´ ë¯¼ì–´ ë§¤ìš´íƒ• 800g,ë©´ì„¸,
D619E,[BOX] ì„¤ë˜ë‹´ ë¯¼ì–´ë§¤ìš´íƒ• 680g x 12ea,ê³¼ì„¸,
D620E,[BOX] ì„¤ë˜ë‹´ ë°”ì§€ë½ìˆ ì°œ 900g (450g x 2ë´‰) x 12ea,ê³¼ì„¸,12
D621E,[BOX] ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D622E,[BOX] ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 400g x 12ê°œì…,ê³¼ì„¸,
D611E,[BOX] ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œê³¨ë“œ 400g x 12ê°œì…,ê³¼ì„¸,12
D879E,[BOX] ì„¤ë˜ë‹´ ì–‘ë… í•´ë¬¼ì¥ 3ì¢… 480g,ê³¼ì„¸,
D624E,[BOX] ì„¤ë˜ë‹´ ì–‘ë…ê½ƒê²Œë¬´ì¹¨ 650g,ë©´ì„¸,12
D624E,[BOX] ì„¤ë˜ë‹´ ì–‘ë…ê½ƒê²Œë¬´ì¹¨ 650g x 12ea,ê³¼ì„¸,
D085E,[BOX] ì„¤ë˜ë‹´ ì˜¤ë…ì˜¤ë… ì¡°ê°œì‚´ì™€ì‚¬ë¹„ 80g (ëƒ‰ë™),ê³¼ì„¸,
D101E,[BOX] ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D001B,[BOX] ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 400g x 12ê°œì…,ê³¼ì„¸,
G039E,[BOX] ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 80gx30ê°œì…,ê³¼ì„¸,30
D632E,[BOX] ì„¤ë˜ë‹´ í•´ë¬¼ì•Œíƒ• 660g x 12ea,ê³¼ì„¸,
D632E,[BOX] ì„¤ë˜ë‹´ í•´ë¬¼ì•Œíƒ• 660g x 12ea,ë©´ì„¸,12
G612E,[BOX] ì‹œë©”ì‚¬ë°” ì½¤ë³´ 2kg,ê³¼ì„¸,5
D624E,[BOX] ì–‘ë…ê½ƒê²Œë¬´ì¹¨(R) 650g x 12ea,ê³¼ì„¸,12
G529E,[BOX] ììˆ™ë¬¸ì–´ë‹¤ë¦¬ 300g,ê³¼ì„¸,30
G629E,[BOX] ììˆ™ë¬¸ì–´ë‹¤ë¦¬ 300g_TRITON,ê³¼ì„¸,
G508E,[BOX] ì „ë³µê²Œìš°ì¥ 400g,ê³¼ì„¸,12
G642E,[BOX] ì¹´ë„¤ì½”ë©” ì—°ì–´ì•Œ 500g,ê³¼ì„¸,
G132E,[BOX] ì½”ëª¨ì¹˜ ì•¼ë¦¬ì´ê¹Œ ì•Œì„ í’ˆì€ í•œì¹˜ 600g(300gx2ea),ê³¼ì„¸,15
G548E,[BOX] í¬ë˜ë¹„ë„Œ ë§¤ì½¤í¬ë© 300g (30gx10ea),ê³¼ì„¸,16
G547E,[BOX] í¬ë˜ë¹„ë„Œ ì˜¤ë¦¬ì§€ë„ 300g (30gx10ea),ê³¼ì„¸,16
G728E,[BOX] í‚¤ìë¯¸ ì™€ì‚¬ë¹„ 250g,ê³¼ì„¸,20
D626E,[BOX] íƒ€ì½”ì™€ì‚¬ë¹„_1kg,ê³¼ì„¸,6
G540E,[BOX] íƒ€ì½”ì™€ì‚¬ë¹„_300g,ê³¼ì„¸,20
G541E,[BOX] íƒ€ì½”ì™€ì‚¬ë¹„_500g,ê³¼ì„¸,12
G643E,[BOX] í† ì™€ìˆ˜ì‚° ì—°ì–´ì•Œ,ê³¼ì„¸,24
D052E,[BOX] í•´ë¬¼ì•Œíƒ•(R) 660g x 12ea,ê³¼ì„¸,
G641E,[BOX] í˜¼ë§ˆìˆ˜ì‚° ì—°ì–´ì•Œ 500g,ê³¼ì„¸,
G654E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •]  êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 230g,ê³¼ì„¸,
G651E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 140g,ê³¼ì„¸,
G652E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 170g,ê³¼ì„¸,
G653E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 200g,ê³¼ì„¸,
G655E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 260g,ê³¼ì„¸,
G658E,[BOX][ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 290g,ê³¼ì„¸,
G501E,[BOX]ê°€ë‹ˆë¯¸ì†Œ1kg,ê³¼ì„¸,6
G502E,[BOX]ê°€ë‹ˆë¯¸ì†Œ400g,ê³¼ì„¸,12
G606E,[BOX]ê°€ì“°ì˜¤ ìŠˆí† ìš° 300g,ê³¼ì„¸,20
G035E,[BOX]ê²Œê°€ë¼ì•„ê²Œ500g_copy1,ê³¼ì„¸,
G503E,[BOX]ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ ë§ˆì¼ë“œ 1kg,ê³¼ì„¸,6
G504E,[BOX]ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ ë§ˆì¼ë“œ 400g,ê³¼ì„¸,12
D001E,[BOX]ê³ ë˜ë¯¸ ì†Œë¼ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
G519E,[BOX]ë‚ ì¹˜ì•Œ[ê³¨ë“œ]300g_copy1,ê³¼ì„¸,20
G520E,[BOX]ë‚ ì¹˜ì•Œ[ê³¨ë“œ]800g_copy1,ê³¼ì„¸,6
G517E,[BOX]ë‚ ì¹˜ì•Œ[ì˜¤ë Œì§€]300g,ê³¼ì„¸,20
G518E,[BOX]ë‚ ì¹˜ì•Œ[ì˜¤ë Œì§€]800g_copy1,ê³¼ì„¸,6
G607E,[BOX]ë§ˆêµ¬ë¡œ ìŠˆí† ìš° 300g,ê³¼ì„¸,20
G511E,[BOX]ë©ê²Œê³ ë…¸ì™€ë‹¤300g,ê³¼ì„¸,20
G025E,[BOX]ëª¨ì¦ˆì¿ 300g,ê³¼ì„¸,
G025E,[BOX]ëª¨ì¦ˆì¿ 300g_copy1,ê³¼ì„¸,
G022E,[BOX]ë°”ì§€ë½ìˆ ì°œ450g_copy1,ê³¼ì„¸,
G525E,[BOX]ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥1kg,ê³¼ì„¸,6
G524E,[BOX]ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥400g_copy1,ê³¼ì„¸,12
D013E,[BOX]ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥80g_copy1,ê³¼ì„¸,30
D018E,[BOX]ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 80g,ë©´ì„¸,30
D014E,[BOX]ì„¤ë˜ë‹´ ë”ì§„í•œë¶‰ì€ëŒ€ê²Œì¥80g_copy1,ê³¼ì„¸,30
D011E,[BOX]ì„¤ë˜ë‹´ ë§ˆë¼ë¡±ìƒ¤ 580g,ë©´ì„¸,
D016E,[BOX]ì„¤ë˜ë‹´ ë§¤ì½¤ì¹ ê²Œì “80g_copy1,ê³¼ì„¸,
D015E,[BOX]ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥80g_copy1,ê³¼ì„¸,30
D017E,[BOX]ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œ(ê³¨ë“œ)80g_copy1,ê³¼ì„¸,30
D017E,[BOX]ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œê³¨ë“œ 80g x 30ê°œì…,ê³¼ì„¸,30
SET001,[BOX]ì„¤ë˜ë‹´ ìš¸ì§„ í”„ë¦¬ë¯¸ì—„ ë¶‰ì€ëŒ€ê²Œ ë¹„ë¹”ë°¥ í‚¤íŠ¸ 162.8g,ê³¼ì„¸,
G039E,[BOX]ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„80g_copy1,ê³¼ì„¸,30
G967E,[BOX]ì†Œë¼ì™€ì‚¬ë¹„500g,ê³¼ì„¸,12
G059E,[BOX]ì—¼ì¥ëª¨ì¦ˆì¿ 750g,ë©´ì„¸,
G535E,[BOX]íë¸Œë§ˆìš”[ì˜¤ë Œì§€]1kg_copy1,ê³¼ì„¸,
G534E,[BOX]íë¸Œë§ˆìš”[ì˜¤ë Œì§€]300_copy1,ê³¼ì„¸,
G537E,[BOX]íë¸Œë§ˆìš”[ì™€ì‚¬ë¹„]1kg_copy1,ê³¼ì„¸,
G536E,[BOX]íë¸Œë§ˆìš”[ì™€ì‚¬ë¹„]300g_copy1,ê³¼ì„¸,
T006E,[BOX]íƒë¯¸í™ˆ êµ´ì§¬ë½•750g_copy1,ë©´ì„¸,
T007E,[BOX]íƒë¯¸í™ˆ ë‚˜ê°€ì‚¬ë¼ì§¬ë½•640g_copy1,ë©´ì„¸,
T002E,[BOX]íƒë¯¸í™ˆ ë”ì§„í•œë¶‰ì€ëŒ€ê²Œì¥60g_copy1,ê³¼ì„¸,
T004E,[BOX]íƒë¯¸í™ˆ ëª¨ë‘ í•´ë¬¼íƒ•750g_copy1,ë©´ì„¸,
T003E,[BOX]íƒë¯¸í™ˆ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥80g,ê³¼ì„¸,
T005E,[BOX]íƒë¯¸í™ˆ ì•Œíƒ•600g_copy1,ë©´ì„¸,
G010E,[BOX]í˜¸íƒ€í…Œì™€ì‚¬ë¹„1kg,ê³¼ì„¸,
G011E,[BOX]í˜¸íƒ€í…Œì™€ì‚¬ë¹„500g,ê³¼ì„¸,
G036E,{BOX} ê³ ë˜ë¯¸ ì¥ì–´êµ¬ì´ [500g],ê³¼ì„¸,
D619E,{BOX} ì„¤ë˜ë‹´ ë¯¼ì–´ë§¤ìš´íƒ• 680g x 12ea,ë©´ì„¸,12
D015E,{BOX} ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 80gX30ê°œì…,ê³¼ì„¸,30
G651E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 140g,ê³¼ì„¸,
G652E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 170g,ê³¼ì„¸,
G653E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 200g,ê³¼ì„¸,
G654E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 230g,ê³¼ì„¸,
G655E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 260g,ê³¼ì„¸,
G658E,[ë´‰ì´ˆë°¥ í‚¤íŠ¸ ì¦ì •] êµ­ë‚´ì‚° ì‹œë©”ì‚¬ë°” 290g,ê³¼ì„¸,
S103E,[ì¶”ê°€êµ¬ì„±] ë¯¸ë‹ˆë½êµ 20g,ê³¼ì„¸,1
S105E,[ì¶”ê°€êµ¬ì„±] ë´‰ì´ˆë°¥í‚¤íŠ¸,ê³¼ì„¸,1
S106E,[ì¶”ê°€êµ¬ì„±] ì‚¬ì‹œë¯¸í‚¤íŠ¸,ê³¼ì„¸,
G726E,[ì¶”ê°€êµ¬ì„±] ìœ ìí°ì¦ˆì†ŒìŠ¤ 30g,ê³¼ì„¸,
S102E,[ì¶”ê°€êµ¬ì„±] ì´ˆëŒ€ë¦¬ 50g,ê³¼ì„¸,1
G604E,ê°€ì“°ì˜¤ ìŠˆí† ìš° 1kg,ê³¼ì„¸,6
G606E,ê°€ì“°ì˜¤ ìŠˆí† ìš° 300g,ê³¼ì„¸,20
G501E,ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ [1kg],ê³¼ì„¸,6
G502E,ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ [400g],ê³¼ì„¸,12
G503E,ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ ë§ˆì¼ë“œ 1kg,ê³¼ì„¸,6
G504E,ê³ ë˜ë¯¸ ê°€ë‹ˆë¯¸ì†Œ ë§ˆì¼ë“œ 400g,ê³¼ì„¸,12
S011E,ê³ ë˜ë¯¸ ê°€ë¼ì•„ê²ŒíŒŒìš°ë” [2kg],ê³¼ì„¸,
G510E,ê³ ë˜ë¯¸ ê°€ì¯”ì˜¤ì°¸ì¹˜ë‹¤ë‹¤ë¼ [1kg],ë©´ì„¸,
G028E,ê³ ë˜ë¯¸ ê°€ì¯”ì˜¤ì°¸ì¹˜ë‹¤ë‹¤ë¼ [2kg],ë©´ì„¸,
G024E,ê³ ë˜ë¯¸ ê°„ì¥ëŒ€í•˜ì¥ [300g],ê³¼ì„¸,
G090E,ê³ ë˜ë¯¸ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 500g,ê³¼ì„¸,12
G035E,ê³ ë˜ë¯¸ ê²Œê°€ë¼ì•„ê²Œ500g,ê³¼ì„¸,
G686E,ê³ ë˜ë¯¸ ê³ ë…¸ì™€ë‹¤ 500g,ë©´ì„¸,12
G123E,ê³ ë˜ë¯¸ ê³ ë˜ì§„ë¯¸ ì„ ë¬¼ì„¸íŠ¸,ê³¼ì„¸,
G034E,ê³ ë˜ë¯¸ ê¹¡ìƒˆìš°ê°€ë¼ì•„ê²Œ [1kg],ê³¼ì„¸,
G656E,ê³ ë˜ë¯¸ ë‚ ì¹˜ì•Œ ìŠ¤ì¹¼ë › 300g,ê³¼ì„¸,20
G097E,ê³ ë˜ë¯¸ ë§ˆë¼í•´ë¬¼ëª¨ë‘  920g x 10EA,ê³¼ì„¸,
G025E,ê³ ë˜ë¯¸ ëª¨ì¦ˆì¿  [300g],ê³¼ì„¸,
G037E,ê³ ë˜ë¯¸ ëª¨ì°Œë¦¬ë„í›„ íŒŒìš°ë” [1kg],ê³¼ì„¸,
G125E,ê³ ë˜ë¯¸ ë¯¸ì‹ ì„ ë¬¼ì„¸íŠ¸,ê³¼ì„¸,
G971E,ê³ ë˜ë¯¸ ë³´íƒ€ë¥´ê°€ 150g + ë¯¸ë‹ˆ ê°•íŒ ì„¸íŠ¸,ê³¼ì„¸,6
G103E,ê³ ë˜ë¯¸ ë¶ˆë§› ì­ˆê¾¸ë¯¸ë³¶ìŒ 340g,ê³¼ì„¸,
G523E,ê³ ë˜ë¯¸ ë¶ˆë§› ì­ˆê¾¸ë¯¸ë³¶ìŒ 800g (400g x 2ea),ê³¼ì„¸,10
G525E,ê³ ë˜ë¯¸ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ [1kg],ê³¼ì„¸,6
G524E,ê³ ë˜ë¯¸ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ [400g],ê³¼ì„¸,12
G033E,ê³ ë˜ë¯¸ ìƒˆìš°ì‚´ê°€ë¼ì•„ê²Œ 1kg,ê³¼ì„¸,
G967E,ê³ ë˜ë¯¸ ì†Œë¼ì™€ì‚¬ë¹„ [500g],ê³¼ì„¸,12
D001E,ê³ ë˜ë¯¸ ì†Œë¼ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
G112E,ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ ìŠ¬ë¼ì´ìŠ¤ 20g,ê³¼ì„¸,10
G952E,ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ ì¹´ë¼ìŠ¤ë¯¸ 1kg,ê³¼ì„¸,5
G137E,ê³ ë˜ë¯¸ ìˆ­ì–´ì–´ë€ íŒŒìš°ë” 60g,ê³¼ì„¸,9
G124E,ê³ ë˜ë¯¸ ìŠ¤ëª°ë¯¸ì‹ ì„ ë¬¼ì„¸íŠ¸,ê³¼ì„¸,
G610E,ê³ ë˜ë¯¸ ì‹œë©”ë‹ˆì‹± L 1kg,ê³¼ì„¸,6
G609E,ê³ ë˜ë¯¸ ì‹œë©”ë‹ˆì‹± M 1kg,ê³¼ì„¸,6
G646E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” L 150g,ê³¼ì„¸,30
G514E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” M 120g,ê³¼ì„¸,30
G649E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” S 100g,ê³¼ì„¸,30
G645E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” XS 70g,ê³¼ì„¸,30
O716E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°” ì‹¤ì†í˜• (ì˜¤ëŠ˜íšŒë¦¬í„´) 1200g (120g x 10ea),ê³¼ì„¸,
G515E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”720g,ê³¼ì„¸,
G516E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”750g,ê³¼ì„¸,
G513E,ê³ ë˜ë¯¸ ì‹œë©”ì‚¬ë°”S [700g],ê³¼ì„¸,
G527E,ê³ ë˜ë¯¸ ì–‘ë…ê¼¬ë§‰ì¥1kg,ê³¼ì„¸,6
G538E,ê³ ë˜ë¯¸ ì–´ë‹ˆì–¸ íƒ€ì½”ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
G138E,ê³ ë˜ë¯¸ ì—°ì–´ì•Œ 250g,ê³¼ì„¸,
G528E,ê³ ë˜ë¯¸ ì—°ì–´íƒ€ë‹¤ë¼ 1kg,ê³¼ì„¸,8
G726E,ê³ ë˜ë¯¸ ìœ ìí°ì¦ˆì†ŒìŠ¤ 1.5kg (30g x 50ea),ê³¼ì„¸,
G135E,ê³ ë˜ë¯¸ ìœ ìí°ì¦ˆì†ŒìŠ¤ 600g,ê³¼ì„¸,
G098E,ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ë©”ë¡œ êµ¬ì´ 450g x 10EA,ê³¼ì„¸,
G099E,ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ë©”ë¡œ ë¨¸ë¦¬ êµ¬ì´ 750g x 10EA,ê³¼ì„¸,
G100E,ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ì—°ì–´ êµ¬ì´ 450g x 10EA,ê³¼ì„¸,
D625E,ê³ ë˜ë¯¸ ìœ¡ì¦™ ê°€ë“ ììˆ™ í†µì˜¤ì§•ì–´ M 500g,ê³¼ì„¸,
G031E,ê³ ë˜ë¯¸ ì´ê¹Œê²Œì†Œê°€ë¼ì•„ê²Œ [1kg],ê³¼ì„¸,
G529E,ê³ ë˜ë¯¸ ììˆ™ë¬¸ì–´ë‹¤ë¦¬ [300g],ë©´ì„¸,30
G023E,ê³ ë˜ë¯¸ ì¥ì–´êµ¬ì´ [150g],ê³¼ì„¸,
G036E,ê³ ë˜ë¯¸ ì¥ì–´êµ¬ì´ [500g],ê³¼ì„¸,
G030E,ê³ ë˜ë¯¸ ì°¸ì¹˜ì•Œì¡°ë¦¼ [1kg],ê³¼ì„¸,
G787E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê³¨ë“œ 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G532E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê³¨ë“œ 300g MSC ì¸ì¦,ê³¼ì„¸,20
G786E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê·¸ë¦° 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G531E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ê·¸ë¦° 300g MSC ì¸ì¦,ê³¼ì„¸,20
G788E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ìŠ¤ì¹¼ë › 160g (80g x 2ea) MSC ì¸ì¦,ê³¼ì„¸,24
G533E,ê³ ë˜ë¯¸ ì²­ì–´ì•Œ ìŠ¤ì¹¼ë › 300g MSC ì¸ì¦,ê³¼ì„¸,20
D695E,ê³ ë˜ë¯¸ ì¹´ì¦ˆë…¸ì½”ë‹ˆì‹± 500g,ê³¼ì„¸,12
G094E,ê³ ë˜ë¯¸ ì½”ëª¨ì¹˜ ì•¼ë¦¬ì´ê¹Œ 750g,ê³¼ì„¸,
O133E,ê³ ë˜ë¯¸ ì½”ëª¨ì¹˜ ì•¼ë¦¬ì´ê¹Œ ì‹¤ì†í˜• (ì˜¤ëŠ˜íšŒë¦¬í„´) 600g (300g x 2ea),ê³¼ì„¸,
G613E,ê³ ë˜ë¯¸ ì¿ ì¹˜ì½” 10g,ê³¼ì„¸,1
G032E,ê³ ë˜ë¯¸ íƒ€ì½”ê°€ë¼ì•„ê²Œ 1kg,ê³¼ì„¸,
D945E,ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ 250g,ê³¼ì„¸,20
G539E,ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ ë§ˆì¼ë“œ 1kg,ê³¼ì„¸,6
G677E,ê³ ë˜ë¯¸ íƒ€ì½”ì™€ì‚¬ë¹„ í”„ë¡œ 1kg,ê³¼ì„¸,6
D631E,ê³ ë˜ë¯¸ í”„ë¡œí ëŸ¬ í´ë¨ ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
D630E,ê³ ë˜ë¯¸ í”„ë¡œí ëŸ¬ í´ë¨ ì™€ì‚¬ë¹„ 500g,ê³¼ì„¸,12
G010E,ê³ ë˜ë¯¸ í˜¸íƒ€í…Œì™€ì‚¬ë¹„ [1kg],ê³¼ì„¸,
G011E,ê³ ë˜ë¯¸ í˜¸íƒ€í…Œì™€ì‚¬ë¹„ [500g],ê³¼ì„¸,
G565E,ê³ ë˜ë¯¸ í™ê²Œì‚´ í¬ë¦¼ íŒŒìŠ¤íƒ€ ì†ŒìŠ¤ 1kg,ê³¼ì„¸,6
G608E,ê³ ë˜ì¡°ê°œ ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,6
D603E,ë‚™ì§€ì—°í¬íƒ•(R) 600g,ê³¼ì„¸,
G519E,ë‚ ì¹˜ì•Œ[ê³¨ë“œ]300g,ê³¼ì„¸,20
G520E,ë‚ ì¹˜ì•Œ[ê³¨ë“œ]800g_copy1,ê³¼ì„¸,6
G517E,ë‚ ì¹˜ì•Œ[ì˜¤ë Œì§€]300g,ê³¼ì„¸,20
G518E,ë‚ ì¹˜ì•Œ[ì˜¤ë Œì§€]800g,ê³¼ì„¸,6
G605E,ë§ˆêµ¬ë¡œ ìŠˆí† ìš° 1kg,ê³¼ì„¸,6
G607E,ë§ˆêµ¬ë¡œ ìŠˆí† ìš° 300g,ê³¼ì„¸,20
D615E,ë§ˆë¼ë£½ìƒ¤(R) 580g x 12ea,ê³¼ì„¸,
D616E,ë§ˆë¼ìƒˆìš°(R) 580g,ê³¼ì„¸,
G522E,ë§¤ì½¤ì¹¼ì¹¼ ë°”ì§€ë½ìˆ ì°œ 500g (ëƒ‰ì¥),ê³¼ì„¸,10
G511E,ë©ê²Œê³ ë…¸ì™€ë‹¤300g,ê³¼ì„¸,20
D618E,ëª¨ë‘ í•´ë¬¼íƒ•(R) 750g,ê³¼ì„¸,
D646E,ëª¨ì¦ˆì¿  80g (ëƒ‰ì¥),ê³¼ì„¸,30
D647E,ëª¨ì¦ˆì¿ (ëƒ‰ì¥) 80g 1+1 ((2ì…)),ê³¼ì„¸,
G521E,ëª¨ì¦ˆì¿ 900g_(ìµœì‹ ),ê³¼ì„¸,8
E011E,ë¯¸ë‹ˆê°•íŒ,ê³¼ì„¸,
D055E,ë¯¼ì–´ë§¤ìš´íƒ•(R) 680g,ê³¼ì„¸,
G644E,ë¶í•´ë„ì‚° ì—°ì–´ì•Œ,ê³¼ì„¸,
D102E,ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D601E,ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 400g (80g x 5ê°œì…),ê³¼ì„¸,
D013E,ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 80g,ê³¼ì„¸,30
D013E,ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ë¹„ë¹”ì¥ 80g x 3ê°œì…,ê³¼ì„¸,
D008E,ì„¤ë˜ë‹´ ê°„ì¥ìƒˆìš°ì¥ 700g,ê³¼ì„¸,
D739E,ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 320g(80g x 4ea)(ëƒ‰ë™),ë©´ì„¸,8
D602E,ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 400g (80g x 5ê°œì…),ë©´ì„¸,
D018E,ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 80g,ë©´ì„¸,30
D018E,ì„¤ë˜ë‹´ ê³ ë…¸ì™€ë‹¤ 80gX3ê°œì…,ë©´ì„¸,
D603E,ì„¤ë˜ë‹´ ë‚™ì§€ì—°í¬íƒ• 600g,ê³¼ì„¸,
D603E,ì„¤ë˜ë‹´ ë‚™ì§€ì—°í¬íƒ• 600g x 3ê°œì… (1.8kg),ê³¼ì„¸,
D603E,ì„¤ë˜ë‹´ ë‚™ì§€ì—°í¬íƒ• 680g,ë©´ì„¸,12
D099E,ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D612E,ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 400g (80g x 5ê°œì…),ê³¼ì„¸,
D014E,ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 80g,ê³¼ì„¸,30
D014E,ì„¤ë˜ë‹´ ë”ì§„í•œ ë¶‰ì€ëŒ€ê²Œì¥ 80gx3ê°œì…,ê³¼ì„¸,
D011E,ì„¤ë˜ë‹´ ë§ˆë¼ë¡±ìƒ¤ 580g,ë©´ì„¸,
D615E,ì„¤ë˜ë‹´ ë§ˆë¼ë£½ìƒ¤ 580g,ê³¼ì„¸,
D010E,ì„¤ë˜ë‹´ ë§ˆë¼ìƒˆìš° 580g,ë©´ì„¸,
D616E,ì„¤ë˜ë‹´ ë§ˆë¼ìƒˆìš° 580g,ê³¼ì„¸,
D617E,ì„¤ë˜ë‹´ ë§¤ì½¤ ì¹ ê²Œì “ 400g (80g x 5ê°œì…),ê³¼ì„¸,
D016E,ì„¤ë˜ë‹´ ë§¤ì½¤ ì¹ ê²Œì “ 80g,ê³¼ì„¸,
D016E,ì„¤ë˜ë‹´ ë§¤ì½¤ ì¹ ê²Œì “ 80g x 3ê°œì…,ê³¼ì„¸,
D618E,ì„¤ë˜ë‹´ ëª¨ë‘ í•´ë¬¼íƒ• 750g,ê³¼ì„¸,
D033E,ì„¤ë˜ë‹´ ë¯¼ì–´ ë§¤ìš´íƒ• 800g,ë©´ì„¸,
D048E,ì„¤ë˜ë‹´ ë¯¼ì–´ë§¤ìš´íƒ• 680g,ê³¼ì„¸,
D619E,ì„¤ë˜ë‹´ ë¯¼ì–´ë§¤ìš´íƒ• 680g x 12ea,ë©´ì„¸,12
D620E,ì„¤ë˜ë‹´ ë°”ì§€ë½ìˆ ì°œ 900g (450g x 2ea ) x 3ê°œì… (2.7kg),ê³¼ì„¸,
D620E,ì„¤ë˜ë‹´ ë°”ì§€ë½ìˆ ì°œ 900g (450g x 2ë´‰),ê³¼ì„¸,12
D621E,ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D622E,ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 400g (80g x 5ê°œì…),ê³¼ì„¸,
D015E,ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 80g,ê³¼ì„¸,30
D015E,ì„¤ë˜ë‹´ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥ 80g x 3ê°œì…,ê³¼ì„¸,
D611E,ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œ 400g (80gx5ê°œì…),ê³¼ì„¸,12
D017E,ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œê³¨ë“œ 80g,ê³¼ì„¸,30
D017E,ì„¤ë˜ë‹´ ìˆœë‚ ì¹˜ì•Œê³¨ë“œ 80g x 3ê°œì…,ê³¼ì„¸,
D879E,ì„¤ë˜ë‹´ ì–‘ë… í•´ë¬¼ì¥ 3ì¢… 480g,ê³¼ì„¸,
D624E,ì„¤ë˜ë‹´ ì–‘ë…ê½ƒê²Œë¬´ì¹¨ 650g,ë©´ì„¸,12
D624E,ì„¤ë˜ë‹´ ì–‘ë…ê½ƒê²Œë¬´ì¹¨ 650g,ê³¼ì„¸,
D968E,ì„¤ë˜ë‹´ ì˜¤ë…ì˜¤ë… ì¡°ê°œì‚´ ì™€ì‚¬ë¹„80g 2ê°œ (ëƒ‰ë™),ê³¼ì„¸,
D968E,ì„¤ë˜ë‹´ ì˜¤ë…ì˜¤ë… ì¡°ê°œì‚´ ì™€ì‚¬ë¹„80g 3ê°œ (ëƒ‰ë™),ê³¼ì„¸,
D968E,ì„¤ë˜ë‹´ ì˜¤ë…ì˜¤ë… ì¡°ê°œì‚´ì™€ì‚¬ë¹„ 80g (ëƒ‰ë™),ê³¼ì„¸,30
SET001,ì„¤ë˜ë‹´ ìš¸ì§„ í”„ë¦¬ë¯¸ì—„ ë¶‰ì€ëŒ€ê²Œ ë¹„ë¹”ë°¥ í‚¤íŠ¸ 162.8g,ê³¼ì„¸,
D101E,ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 320g(80g x 4ea)(ëƒ‰ë™),ê³¼ì„¸,8
D001B,ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 400g (80g x 5ê°œì…),ê³¼ì„¸,
G039E,ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 80g,ê³¼ì„¸,30
G039E,ì„¤ë˜ë‹´ íƒ€ì½”ì™€ì‚¬ë¹„ 80g x 3ê°œì…,ê³¼ì„¸,
D632E,ì„¤ë˜ë‹´ í•´ë¬¼ì•Œíƒ• 660g,ê³¼ì„¸,
D632E,ì„¤ë˜ë‹´ í•´ë¬¼ì•Œíƒ• 660g x 12ea,ë©´ì„¸,12
G612E,ì‹œë©”ì‚¬ë°” ì½¤ë³´ 2kg,ê³¼ì„¸,5
D624E,ì–‘ë…ê½ƒê²Œë¬´ì¹¨(R) 650g,ê³¼ì„¸,
G059E,ì—¼ì¥ëª¨ì¦ˆì¿ 750g_copy1,ë©´ì„¸,
G629E,ììˆ™ë¬¸ì–´ë‹¤ë¦¬ 300g_TRITON,ê³¼ì„¸,
G508E,ì „ë³µê²Œìš°ì¥ 400g,ê³¼ì„¸,12
E006E,ì¡°ë¯¸ ì‚¬ê° ìœ ë¶€ (T-100),ê³¼ì„¸,
G642E,ì¹´ë„¤ì½”ë©” ì—°ì–´ì•Œ 500g,ê³¼ì„¸,
G132E,ì½”ëª¨ì¹˜ ì•¼ë¦¬ì´ê¹Œ ì•Œì„ í’ˆì€ í•œì¹˜ 600g(300gx2ea),ê³¼ì„¸,15
G535E,íë¸Œë§ˆìš”[ì˜¤ë Œì§€]1kg_copy1,ê³¼ì„¸,
G534E,íë¸Œë§ˆìš”[ì˜¤ë Œì§€]300g,ê³¼ì„¸,
G537E,íë¸Œë§ˆìš”[ì™€ì‚¬ë¹„]1kg,ê³¼ì„¸,
G536E,íë¸Œë§ˆìš”[ì™€ì‚¬ë¹„]300g_copy1,ê³¼ì„¸,
G548E,í¬ë˜ë¹„ë„Œ ë§¤ì½¤í¬ë© 300g (30g10ea),ê³¼ì„¸,16
C557E,í¬ë˜ë¹„ë„Œ ë§¤ì½¤í¬ë© 30g,ê³¼ì„¸,
G547E,í¬ë˜ë¹„ë„Œ ì˜¤ë¦¬ì§€ë„ 300g (30gx10ea),ê³¼ì„¸,16
C556E,í¬ë˜ë¹„ë„Œ ì˜¤ë¦¬ì§€ë„ 30g,ê³¼ì„¸,
G728E,í‚¤ìë¯¸ ì™€ì‚¬ë¹„ 250g,ê³¼ì„¸,20
D626E,íƒ€ì½”ì™€ì‚¬ë¹„_1kg,ê³¼ì„¸,6
G540E,íƒ€ì½”ì™€ì‚¬ë¹„_300g,ê³¼ì„¸,20
G541E,íƒ€ì½”ì™€ì‚¬ë¹„_500g,ê³¼ì„¸,12
G003E,íƒ€ì½”ì™€ì‚¬ë¹„300g,ê³¼ì„¸,
T006E,íƒë¯¸í™ˆ êµ´ì§¬ë½•750g,ë©´ì„¸,
T007E,íƒë¯¸í™ˆ ë‚˜ê°€ì‚¬ë¼ì§¬ë½•640g,ë©´ì„¸,
T002E,"íƒë¯¸í™ˆ ë”ì§„í•œë¶‰ì€ëŒ€ê²Œì¥60g,3ê°œì…_copy1",ê³¼ì„¸,
T004E,íƒë¯¸í™ˆ ëª¨ë‘ í•´ë¬¼íƒ• [750g],ë©´ì„¸,
G022E,íƒë¯¸í™ˆ ë°”ì§€ë½ìˆ ì°œ [450g],ê³¼ì„¸,
T003E,"íƒë¯¸í™ˆ ë¶‰ì€ëŒ€ê²Œë”±ì§€ì¥80g,3ê°œì…",ê³¼ì„¸,
T005E,íƒë¯¸í™ˆ í•´ë¬¼ì•Œíƒ• [600g],ë©´ì„¸,
G643E,í† ì™€ìˆ˜ì‚° ì—°ì–´ì•Œ 500g,ê³¼ì„¸,
P001E,íŠ¹ê°€íŒë§¤ ì†Œë¼ì™€ì‚¬ë¹„ 1kg,ê³¼ì„¸,
D052E,í•´ë¬¼ì•Œíƒ•(R) 660g,ê³¼ì„¸,
G641E,í˜¼ë§ˆìˆ˜ì‚° ì—°ì–´ì•Œ 500g,ê³¼ì„¸,
"""
        # ë¬¸ìì—´ ë°ì´í„°ë¥¼ íŒŒì¼ì²˜ëŸ¼ ì½ì–´ì„œ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ë³€í™˜
        df_master = pd.read_csv(io.StringIO(master_data_string))
        
        # 1. ì‚¬ìš©ì ì—…ë¡œë“œ íŒŒì¼ ì½ê¸°
        df_smartstore = pd.read_excel(file1)
        df_ecount_orig = pd.read_excel(file2)
        df_godomall = pd.read_excel(file3)

        # 2. ê¸ˆì•¡ ë³´ì •í•˜ì—¬ ìµœì¢… ì£¼ë¬¸ ëª©ë¡ ìƒì„±
        df_final = df_ecount_orig.copy().rename(columns={'ê¸ˆì•¡': 'ì‹¤ê²°ì œê¸ˆì•¡'})
        
        key_cols_smartstore = ['ì¬ê³ ê´€ë¦¬ì½”ë“œ', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ìˆ˜ë ¹ìëª…']
        smartstore_prices = df_smartstore.rename(columns={'ì‹¤ê²°ì œê¸ˆì•¡': 'ìˆ˜ì •ë _ê¸ˆì•¡_ìŠ¤í† ì–´'})[key_cols_smartstore + ['ìˆ˜ì •ë _ê¸ˆì•¡_ìŠ¤í† ì–´']].drop_duplicates(subset=key_cols_smartstore, keep='first')
        
        godomall_prices = df_godomall.copy()
        last_col_name = godomall_prices.columns[-1]
        godomall_prices['ìˆ˜ì •ë _ê¸ˆì•¡_ê³ ë„ëª°'] = pd.to_numeric(godomall_prices[last_col_name].astype(str).str.replace(',', ''), errors='coerce')
        key_cols_godomall_orig = ['ìˆ˜ì·¨ì¸ ì´ë¦„', 'ìƒí’ˆìˆ˜ëŸ‰', 'ìƒí’ˆë³„ í’ˆëª©ê¸ˆì•¡']
        godomall_prices_for_merge = godomall_prices[key_cols_godomall_orig + ['ìˆ˜ì •ë _ê¸ˆì•¡_ê³ ë„ëª°']].rename(columns={'ìˆ˜ì·¨ì¸ ì´ë¦„': 'ìˆ˜ë ¹ìëª…', 'ìƒí’ˆìˆ˜ëŸ‰': 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ìƒí’ˆë³„ í’ˆëª©ê¸ˆì•¡': 'ì‹¤ê²°ì œê¸ˆì•¡'}).drop_duplicates(subset=['ìˆ˜ë ¹ìëª…', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ì‹¤ê²°ì œê¸ˆì•¡'], keep='first')
        
        df_final = pd.merge(df_final, smartstore_prices, on=key_cols_smartstore, how='left')
        df_final = pd.merge(df_final, godomall_prices_for_merge, on=['ìˆ˜ë ¹ìëª…', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ì‹¤ê²°ì œê¸ˆì•¡'], how='left')
        
        warnings = [f"- [ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´] ìˆ˜ë ¹ìëª…: **{row['ìˆ˜ë ¹ìëª…']}**, ìƒí’ˆëª…: {row['SKUìƒí’ˆëª…']}" for _, row in df_final[(df_final['ì‡¼í•‘ëª°'] == 'ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´') & (df_final['ìˆ˜ì •ë _ê¸ˆì•¡_ìŠ¤í† ì–´'].isna())].iterrows()]
        warnings.extend([f"- [ê³ ë„ëª°5] ìˆ˜ë ¹ìëª…: **{row['ìˆ˜ë ¹ìëª…']}**, ìƒí’ˆëª…: {row['SKUìƒí’ˆëª…']}" for _, row in df_final[(df_final['ì‡¼í•‘ëª°'] == 'ê³ ë„ëª°5') & (df_final['ìˆ˜ì •ë _ê¸ˆì•¡_ê³ ë„ëª°'].isna())].iterrows()])
        
        df_final['ì‹¤ê²°ì œê¸ˆì•¡'] = np.where(df_final['ì‡¼í•‘ëª°'] == 'ê³ ë„ëª°5', df_final['ìˆ˜ì •ë _ê¸ˆì•¡_ê³ ë„ëª°'].fillna(df_final['ì‹¤ê²°ì œê¸ˆì•¡']), df_final['ì‹¤ê²°ì œê¸ˆì•¡'])
        df_final['ì‹¤ê²°ì œê¸ˆì•¡'] = np.where(df_final['ì‡¼í•‘ëª°'] == 'ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´', df_final['ìˆ˜ì •ë _ê¸ˆì•¡_ìŠ¤í† ì–´'].fillna(df_final['ì‹¤ê²°ì œê¸ˆì•¡']), df_final['ì‹¤ê²°ì œê¸ˆì•¡'])
        
        df_main_result = df_final[['ì¬ê³ ê´€ë¦¬ì½”ë“œ', 'SKUìƒí’ˆëª…', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ì‹¤ê²°ì œê¸ˆì•¡', 'ì‡¼í•‘ëª°', 'ìˆ˜ë ¹ìëª…']]
        
        # 3. ë¬¼ë¥˜íŒ€ìš© íŒŒì¼ 2ì¢… ìƒì„±
        df_quantity_summary = df_main_result.groupby('SKUìƒí’ˆëª…', as_index=False)['ì£¼ë¬¸ìˆ˜ëŸ‰'].sum().rename(columns={'ì£¼ë¬¸ìˆ˜ëŸ‰': 'ê°œìˆ˜'})
        df_packing_list = df_main_result[['SKUìƒí’ˆëª…', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ìˆ˜ë ¹ìëª…', 'ì‡¼í•‘ëª°']].copy()
        is_first_item = df_packing_list['ìˆ˜ë ¹ìëª…'] != df_packing_list['ìˆ˜ë ¹ìëª…'].shift(1)
        df_packing_list['ë¬¶ìŒë²ˆí˜¸'] = is_first_item.cumsum()
        df_packing_list_final = df_packing_list.copy()
        df_packing_list_final['ë¬¶ìŒë²ˆí˜¸'] = df_packing_list_final['ë¬¶ìŒë²ˆí˜¸'].where(is_first_item, '')
        df_packing_list_final = df_packing_list_final[['ë¬¶ìŒë²ˆí˜¸', 'SKUìƒí’ˆëª…', 'ì£¼ë¬¸ìˆ˜ëŸ‰', 'ìˆ˜ë ¹ìëª…', 'ì‡¼í•‘ëª°']]

        # 4. ì´ì¹´ìš´íŠ¸ ì—…ë¡œë“œìš© íŒŒì¼ ìƒì„±
        df_merged = pd.merge(df_main_result, df_master[['SKUì½”ë“œ', 'ê³¼ì„¸ì—¬ë¶€', 'ì…ìˆ˜ëŸ‰']], left_on='ì¬ê³ ê´€ë¦¬ì½”ë“œ', right_on='SKUì½”ë“œ', how='left')
        
        unmastered = df_merged[df_merged['SKUì½”ë“œ'].isna()]
        for _, row in unmastered.iterrows():
            warnings.append(f"- [ë¯¸ë“±ë¡ ìƒí’ˆ] ìƒí’ˆì½”ë“œ: **{row['ì¬ê³ ê´€ë¦¬ì½”ë“œ']}**ê°€ ìƒí’ˆ ë§ˆìŠ¤í„°ì— ì—†ìŠµë‹ˆë‹¤.")

        client_map = {'ì¿ íŒ¡': 'ì¿ íŒ¡ ì£¼ì‹íšŒì‚¬', 'ê³ ë„ëª°5': 'ê³ ë˜ë¯¸ìì‚¬ëª°_í˜„ê¸ˆì˜ìˆ˜ì¦(ê³ ë„ëª°)', 'ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´': 'ìŠ¤í† ì–´íŒœ', 'ë°°ë¯¼ìƒíšŒ': 'ì£¼ì‹íšŒì‚¬ ìš°ì•„í•œí˜•ì œë“¤(ë°°ë¯¼ìƒíšŒ)', 'ì´ì§€ì›°': 'ì£¼ì‹íšŒì‚¬ í˜„ëŒ€ì´ì§€ì›°'}
        
        df_ecount_upload = pd.DataFrame()
        df_ecount_upload['ì¼ì'] = datetime.now().strftime("%Y%m%d")
        df_ecount_upload['ê±°ë˜ì²˜ëª…'] = df_merged['ì‡¼í•‘ëª°'].map(client_map).fillna(df_merged['ì‡¼í•‘ëª°'])
        df_ecount_upload['ì¶œí•˜ì°½ê³ '] = 'ê³ ë˜ë¯¸'
        df_ecount_upload['ê±°ë˜ìœ í˜•'] = np.where(df_merged['ê³¼ì„¸ì—¬ë¶€'] == 'ë©´ì„¸', 12, 11)
        
        # <<-- ìˆ˜ì •ëœ ë¶€ë¶„ 1: 'ì ìš”_ì „í‘œ'ë¡œ ì´ë¦„ ë³€ê²½ -->>
        df_ecount_upload['ì ìš”_ì „í‘œ'] = 'ì˜¤ì „/ì˜¨ë¼ì¸'
        
        df_ecount_upload['í’ˆëª©ì½”ë“œ'] = df_merged['ì¬ê³ ê´€ë¦¬ì½”ë“œ']
        
        is_box = df_merged['SKUìƒí’ˆëª…'].str.contains('BOX', na=False)
        df_ecount_upload['ë°•ìŠ¤'] = np.where(is_box, df_merged['ì£¼ë¬¸ìˆ˜ëŸ‰'], "")
        
        ì…ìˆ˜ëŸ‰ = pd.to_numeric(df_merged['ì…ìˆ˜ëŸ‰'], errors='coerce').fillna(1)
        df_ecount_upload['ìˆ˜ëŸ‰'] = np.where(is_box, df_merged['ì£¼ë¬¸ìˆ˜ëŸ‰'] * ì…ìˆ˜ëŸ‰, df_merged['ì£¼ë¬¸ìˆ˜ëŸ‰']).astype(int)
        
        df_merged['ì‹¤ê²°ì œê¸ˆì•¡'] = pd.to_numeric(df_merged['ì‹¤ê²°ì œê¸ˆì•¡'], errors='coerce').fillna(0)
        ê³µê¸‰ê°€ì•¡ = np.where(df_merged['ê³¼ì„¸ì—¬ë¶€'] == 'ê³¼ì„¸', df_merged['ì‹¤ê²°ì œê¸ˆì•¡'] / 1.1, df_merged['ì‹¤ê²°ì œê¸ˆì•¡'])
        df_ecount_upload['ê³µê¸‰ê°€ì•¡'] = ê³µê¸‰ê°€ì•¡
        df_ecount_upload['ë¶€ê°€ì„¸'] = df_merged['ì‹¤ê²°ì œê¸ˆì•¡'] - df_ecount_upload['ê³µê¸‰ê°€ì•¡']
        
        df_ecount_upload['ì‡¼í•‘ëª°ê³ ê°ëª…'] = df_merged['ìˆ˜ë ¹ìëª…']
        
        # <<-- ìˆ˜ì •ëœ ë¶€ë¶„ 2: 'ì ìš”'ë¥¼ 'ì ìš”_ì „í‘œ'ì™€ 'ì ìš”_í’ˆëª©'ìœ¼ë¡œ ë¶„ë¦¬ -->>
        ecount_columns = [
            'ì¼ì', 'ìˆœë²ˆ', 'ê±°ë˜ì²˜ì½”ë“œ', 'ê±°ë˜ì²˜ëª…', 'ë‹´ë‹¹ì', 'ì¶œí•˜ì°½ê³ ', 'ê±°ë˜ìœ í˜•', 'í†µí™”', 'í™˜ìœ¨', 
            'ì ìš”_ì „í‘œ', 'ë¯¸ìˆ˜ê¸ˆ', 'ì´í•©ê³„', 'ì—°ê²°ì „í‘œ', 'í’ˆëª©ì½”ë“œ', 'í’ˆëª©ëª…', 'ê·œê²©', 'ë°•ìŠ¤', 'ìˆ˜ëŸ‰', 
            'ë‹¨ê°€', 'ì™¸í™”ê¸ˆì•¡', 'ê³µê¸‰ê°€ì•¡', 'ë¶€ê°€ì„¸', 'ì ìš”_í’ˆëª©', 'ìƒì‚°ì „í‘œìƒì„±', 'ì‹œë¦¬ì–¼/ë¡œíŠ¸', 
            'ê´€ë¦¬í•­ëª©', 'ì‡¼í•‘ëª°ê³ ê°ëª…'
        ]
        for col in ecount_columns:
            if col not in df_ecount_upload:
                df_ecount_upload[col] = ''
        
        for col in ['ê³µê¸‰ê°€ì•¡', 'ë¶€ê°€ì„¸']:
            df_ecount_upload[col] = df_ecount_upload[col].round().astype('Int64')

        df_ecount_upload = df_ecount_upload[ecount_columns]

        return df_main_result, df_quantity_summary, df_packing_list_final, df_ecount_upload, True, "ëª¨ë“  íŒŒì¼ ì²˜ë¦¬ê°€ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.", warnings

    except Exception as e:
        import traceback
        st.error(f"ì˜¤ë¥˜ ë°œìƒ: {e}")
        st.error(traceback.format_exc()) # ë””ë²„ê¹…ì„ ìœ„í•´ ì „ì²´ ì˜¤ë¥˜ ë¡œê·¸ë¥¼ ì¶œë ¥
        return None, None, None, None, False, f"ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}. ë‚´ë¶€ ë¡œì§ì„ í™•ì¸í•´ì£¼ì„¸ìš”.", []


# --------------------------------------------------------------------------
# Streamlit ì•± UI êµ¬ì„±
# --------------------------------------------------------------------------
st.set_page_config(page_title="ì£¼ë¬¸ ì²˜ë¦¬ ìë™í™” v.Ultimate-Fix", layout="wide")
st.title("ğŸ“‘ ì£¼ë¬¸ ì²˜ë¦¬ ìë™í™” (v.Ultimate-Fix)")
st.info("ğŸ’¡ 3ê°œì˜ ì£¼ë¬¸ ê´€ë ¨ íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´, ê¸ˆì•¡ ë³´ì •, ë¬¼ë¥˜, ERP(ì´ì¹´ìš´íŠ¸)ìš© ë°ì´í„°ê°€ í•œ ë²ˆì— ìƒì„±ë©ë‹ˆë‹¤.")
st.write("---")

st.header("1. ì›ë³¸ ì—‘ì…€ íŒŒì¼ 3ê°œ ì—…ë¡œë“œ")
col1, col2, col3 = st.columns(3)
with col1:
    file1 = st.file_uploader("1ï¸âƒ£ ìŠ¤ë§ˆíŠ¸ìŠ¤í† ì–´ (ê¸ˆì•¡í™•ì¸ìš©)", type=['xlsx', 'xls', 'csv'])
with col2:
    file2 = st.file_uploader("2ï¸âƒ£ ì´ì¹´ìš´íŠ¸ ë‹¤ìš´ë¡œë“œ (ì£¼ë¬¸ëª©ë¡)", type=['xlsx', 'xls', 'csv'])
with col3:
    file3 = st.file_uploader("3ï¸âƒ£ ê³ ë„ëª° (ê¸ˆì•¡í™•ì¸ìš©)", type=['xlsx', 'xls', 'csv'])

st.write("---")
st.header("2. ì²˜ë¦¬ ê²°ê³¼ í™•ì¸ ë° ë‹¤ìš´ë¡œë“œ")
if st.button("ğŸš€ ëª¨ë“  ë°ì´í„° ì²˜ë¦¬ ë° íŒŒì¼ ìƒì„± ì‹¤í–‰"):
    if file1 and file2 and file3:
        with st.spinner('ëª¨ë“  íŒŒì¼ì„ ì½ê³  ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ë©° ì—‘ì…€ ì„œì‹ì„ ì ìš© ì¤‘ì…ë‹ˆë‹¤...'):
            df_main, df_qty, df_pack, df_ecount, success, message, warnings = process_all_files(file1, file2, file3)
        
        if success:
            st.success(message)
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")

            if warnings:
                st.warning("âš ï¸ í™•ì¸ í•„ìš” í•­ëª©")
                with st.expander("ìì„¸í•œ ëª©ë¡ ë³´ê¸°..."):
                    st.info("ê¸ˆì•¡ ë³´ì • ì‹¤íŒ¨ ë˜ëŠ” ë¯¸ë“±ë¡ ìƒí’ˆ ë“±ì˜ ë°ì´í„°ì…ë‹ˆë‹¤. ì›ë³¸ íŒŒì¼ì„ í™•ì¸í•´ì£¼ì„¸ìš”.")
                    for warning_message in warnings: st.markdown(warning_message)
            
            tab_erp, tab_pack, tab_qty, tab_main = st.tabs(["ğŸ¢ **ì´ì¹´ìš´íŠ¸ ì—…ë¡œë“œìš©**", "ğŸ“‹ í¬ì¥ ë¦¬ìŠ¤íŠ¸", "ğŸ“¦ ì¶œê³ ìˆ˜ëŸ‰ ìš”ì•½", "âœ… ìµœì¢… ë³´ì • ë¦¬ìŠ¤íŠ¸"])
            
            with tab_erp:
                # í™”ë©´ í‘œì‹œëŠ” .astype(str)ë¡œ ì•ˆì „í•˜ê²Œ ì²˜ë¦¬
                st.dataframe(df_ecount.astype(str))
                # ë‹¤ìš´ë¡œë“œ íŒŒì¼ì€ to_excel_formatted í•¨ìˆ˜ì—ì„œ ì²˜ë¦¬í•˜ë¯€ë¡œ ì›ë³¸ df_ecount ì „ë‹¬
                st.download_button("ğŸ“¥ ë‹¤ìš´ë¡œë“œ", to_excel_formatted(df_ecount), f"ì´ì¹´ìš´íŠ¸_ì—…ë¡œë“œìš©_{timestamp}.xlsx")

            with tab_pack:
                st.dataframe(df_pack)
                st.download_button("ğŸ“¥ ë‹¤ìš´ë¡œë“œ", to_excel_formatted(df_pack, format_type='packing_list'), f"ë¬¼ë¥˜íŒ€_ì „ë‹¬ìš©_í¬ì¥ë¦¬ìŠ¤íŠ¸_{timestamp}.xlsx")

            with tab_qty:
                st.dataframe(df_qty)
                st.download_button("ğŸ“¥ ë‹¤ìš´ë¡œë“œ", to_excel_formatted(df_qty), f"ë¬¼ë¥˜íŒ€_ì „ë‹¬ìš©_ì¶œê³ ìˆ˜ëŸ‰_{timestamp}.xlsx")
            
            with tab_main:
                st.dataframe(df_main)
                st.download_button("ğŸ“¥ ë‹¤ìš´ë¡œë“œ", to_excel_formatted(df_main), f"ìµœì¢…_ì‹¤ê²°ì œê¸ˆì•¡_ë³´ì •ì™„ë£Œ_{timestamp}.xlsx")

        else:
            st.error(message)
    else:
        st.warning("âš ï¸ 3ê°œì˜ ì—‘ì…€ íŒŒì¼ì„ ëª¨ë‘ ì—…ë¡œë“œí•´ì•¼ ì‹¤í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
